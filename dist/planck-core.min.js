!function(t,r){"object"==typeof exports&&"undefined"!=typeof module?r(exports):"function"==typeof define&&define.amd?define(["exports"],r):r(t.Planck=t.Planck||{})}(this,function(t){"use strict";function r(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:void 0,r=Symbol(t);return function(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:function(t){return t};return void 0===t[r]&&(t[r]=n({})),t[r]}}var n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},e=function(t,r){if(!(t instanceof r))throw new TypeError("Cannot call a class as a function")},o=function(){function t(t,r){for(var n=0;n<r.length;n++){var e=r[n];e.enumerable=e.enumerable||!1,e.configurable=!0,"value"in e&&(e.writable=!0),Object.defineProperty(t,e.key,e)}}return function(r,n,e){return n&&t(r.prototype,n),e&&t(r,e),r}}(),i=function(){return function(t,r){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return function(t,r){var n=[],e=!0,o=!1,i=void 0;try{for(var a,u=t[Symbol.iterator]();!(e=(a=u.next()).done)&&(n.push(a.value),!r||n.length!==r);e=!0);}catch(t){o=!0,i=t}finally{try{!e&&u.return&&u.return()}finally{if(o)throw i}}return n}(t,r);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),a=function(t){if(Array.isArray(t)){for(var r=0,n=Array(t.length);r<t.length;r++)n[r]=t[r];return n}return Array.from(t)},u=r("AggregateFunction"),s=function(){function t(r){if(e(this,t),r!==u)throw new Error;for(var n=u(this),o=arguments.length,i=Array(o>1?o-1:0),a=1;a<o;a++)i[a-1]=arguments[a];n.targets=i}return o(t,[{key:"apply",value:function(t,r,n){for(var e=u(this).targets,o=[],i=0;i<e.length;++i)o.push(e[i].apply(r,n));return o}}],[{key:"new",value:function(){for(var t=arguments.length,r=Array(t),n=0;n<t;n++)r[n]=arguments[n];var e=new(Function.prototype.bind.apply(this,[null].concat([u],r)));return new Proxy(function(){},e)}}]),t}(),f=r("Aggregate"),c=function(){function t(r){if(e(this,t),r!==f)throw new Error;for(var n=f(this),o=arguments.length,i=Array(o>1?o-1:0),a=1;a<o;a++)i[a-1]=arguments[a];n.targets=i}return o(t,[{key:"set",value:function(t,r,n,e){for(var o=f(this).targets,i=0;i<o.length;++i)o[i][r]=n;return t[r]=n,!0}},{key:"get",value:function(t,r,n){for(var e=f(this),o=e.targets,i=0;i<o.length;++i)if("function"!=typeof t[r])return e.targets[0][r];for(var a=[],u=0;u<o.length;++u){var c=o[u];a.push(c[r].bind(c))}return s.new.apply(s,a)}}],[{key:"new",value:function(){for(var t=arguments.length,r=Array(t),n=0;n<t;n++)r[n]=arguments[n];var e=new(Function.prototype.bind.apply(this,[null].concat([f],r)));return new Proxy({},e)}}]),t}();var l={min:function(t,r){var n=void 0,e=Number.POSITIVE_INFINITY;if("function"!=typeof r){for(var o=0;o<t.length;++o){var i=t[o];i<e&&(n=i,e=i)}return n}for(var a=0;a<t.length;++a){var u=t[a],s=r(u,a);s<e&&(n=u,e=s)}return n},max:function(t,r){var n=void 0,e=Number.NEGATIVE_INFINITY;if("function"!=typeof r){for(var o=0;o<t.length;++o){var i=t[o];i>e&&(n=i,e=i)}return n}for(var a=0;a<t.length;++a){var u=t[a],s=r(u,a);s>e&&(n=u,e=s)}return n}};function h(t){this.message=t}Object.setPrototypeOf(h,Error),(h.prototype=Object.create(Error.prototype)).name="AssertionError",h.prototype.message="",h.prototype.constructor=h;var p=function(){try{if(new Function("return this === window")())return!0}catch(t){}return!1}(),v=!p&&function(){try{if(new Function("return this === self")())return!0}catch(t){}return!1}(),y=!p&&!v&&function(){try{if(new Function("return this === global")())return!0}catch(t){}return!1}(),g=p?window:v?self:y?global:void 0,d={isBrowser:p,isWorker:v,isNode:y,scope:g};function b(t){var r=void 0,n=void 0;if("string"==typeof t)n=t,r=t;else{var e=Object.keys(t);r=t[n=i(e,1)[0]]}if(process.browser)return g[r];if(y)try{return require(n)}catch(t){}}function m(t){try{return b(t)}catch(t){g.process={browser:!y}}return b(t)}function w(t){var r=m(t);if(void 0===r){if(y)throw new Error('Could not resolve module "'+t+'"');return{}}return r}Object.assign(m,{optional:function(t){var r=m(t);return void 0===r?{}:r},required:function(t){var r=m(t);if(void 0===r)throw y?new Error('Could not resolve module "'+t+'"'):new Error('"'+t+'" isn’t defined in the global scope');return r},node:w,browser:function(t){var r=m(t);if(void 0===r){if(!y)throw new Error('"'+t+'" isn’t defined in the global scope');return{}}return r}});var A="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{};function j(t,r){return t(r={exports:{}},r.exports),r.exports}var x=j(function(t,r){function n(t,r){for(var n=0,e=t.length-1;e>=0;e--){var o=t[e];"."===o?t.splice(e,1):".."===o?(t.splice(e,1),n++):n&&(t.splice(e,1),n--)}if(r)for(;n--;n)t.unshift("..");return t}var e=/^(\/?|)([\s\S]*?)((?:\.{1,2}|[^\/]+?|)(\.[^.\/]*|))(?:[\/]*)$/,o=function(t){return e.exec(t).slice(1)};r.resolve=function(){for(var t="",r=!1,e=arguments.length-1;e>=-1&&!r;e--){var o=e>=0?arguments[e]:process.cwd();if("string"!=typeof o)throw new TypeError("Arguments to path.resolve must be strings");o&&(t=o+"/"+t,r="/"===o.charAt(0))}return t=n(i(t.split("/"),function(t){return!!t}),!r).join("/"),(r?"/":"")+t||"."},r.normalize=function(t){var e=r.isAbsolute(t),o="/"===a(t,-1);return(t=n(i(t.split("/"),function(t){return!!t}),!e).join("/"))||e||(t="."),t&&o&&(t+="/"),(e?"/":"")+t},r.isAbsolute=function(t){return"/"===t.charAt(0)},r.join=function(){var t=Array.prototype.slice.call(arguments,0);return r.normalize(i(t,function(t,r){if("string"!=typeof t)throw new TypeError("Arguments to path.join must be strings");return t}).join("/"))},r.relative=function(t,n){t=r.resolve(t).substr(1),n=r.resolve(n).substr(1);function e(t){for(var r=0;r<t.length&&""===t[r];r++);for(var n=t.length-1;n>=0&&""===t[n];n--);return r>n?[]:t.slice(r,n-r+1)}for(var o=e(t.split("/")),i=e(n.split("/")),a=Math.min(o.length,i.length),u=a,s=0;s<a;s++)if(o[s]!==i[s]){u=s;break}var f=[];for(s=u;s<o.length;s++)f.push("..");return(f=f.concat(i.slice(u))).join("/")},r.sep="/",r.delimiter=":",r.dirname=function(t){var r=o(t),n=r[0],e=r[1];return n||e?(e&&(e=e.substr(0,e.length-1)),n+e):"."},r.basename=function(t,r){var n=o(t)[2];return r&&n.substr(-1*r.length)===r&&(n=n.substr(0,n.length-r.length)),n},r.extname=function(t){return o(t)[3]};function i(t,r){if(t.filter)return t.filter(r);for(var n=[],e=0;e<t.length;e++)r(t[e],e,t)&&n.push(t[e]);return n}var a="b"==="ab".substr(-1)?function(t,r,n){return t.substr(r,n)}:function(t,r,n){return r<0&&(r=t.length+r),t.substr(r,n)}}),S=(x.resolve,x.normalize,x.isAbsolute,x.join,x.relative,x.sep,x.delimiter,x.dirname,x.basename,x.extname,w("path")),O={resolve:y?S.resolve:function(){for(var t=arguments.length,r=Array(t),n=0;n<t;n++)r[n]=arguments[n];return x.resolve.apply(x,["/"].concat(r))},normalize:y?S.normalize:x.normalize,join:y?S.join:x.join,relative:y?S.relative:x.relative,dirname:y?S.dirname:x.dirname,basename:y?S.basename:x.basename,extname:y?S.extname:x.extname,delimiter:y?S.delimiter:x.delimiter,sep:y?S.sep:x.sep},E=j(function(t){!function(){var r="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",n={rotl:function(t,r){return t<<r|t>>>32-r},rotr:function(t,r){return t<<32-r|t>>>r},endian:function(t){if(t.constructor==Number)return 16711935&n.rotl(t,8)|4278255360&n.rotl(t,24);for(var r=0;r<t.length;r++)t[r]=n.endian(t[r]);return t},randomBytes:function(t){for(var r=[];t>0;t--)r.push(Math.floor(256*Math.random()));return r},bytesToWords:function(t){for(var r=[],n=0,e=0;n<t.length;n++,e+=8)r[e>>>5]|=t[n]<<24-e%32;return r},wordsToBytes:function(t){for(var r=[],n=0;n<32*t.length;n+=8)r.push(t[n>>>5]>>>24-n%32&255);return r},bytesToHex:function(t){for(var r=[],n=0;n<t.length;n++)r.push((t[n]>>>4).toString(16)),r.push((15&t[n]).toString(16));return r.join("")},hexToBytes:function(t){for(var r=[],n=0;n<t.length;n+=2)r.push(parseInt(t.substr(n,2),16));return r},bytesToBase64:function(t){for(var n=[],e=0;e<t.length;e+=3)for(var o=t[e]<<16|t[e+1]<<8|t[e+2],i=0;i<4;i++)8*e+6*i<=8*t.length?n.push(r.charAt(o>>>6*(3-i)&63)):n.push("=");return n.join("")},base64ToBytes:function(t){t=t.replace(/[^A-Z0-9+\/]/gi,"");for(var n=[],e=0,o=0;e<t.length;o=++e%4)0!=o&&n.push((r.indexOf(t.charAt(e-1))&Math.pow(2,-2*o+8)-1)<<2*o|r.indexOf(t.charAt(e))>>>6-2*o);return n}};t.exports=n}()}),C={utf8:{stringToBytes:function(t){return C.bin.stringToBytes(unescape(encodeURIComponent(t)))},bytesToString:function(t){return decodeURIComponent(escape(C.bin.bytesToString(t)))}},bin:{stringToBytes:function(t){for(var r=[],n=0;n<t.length;n++)r.push(255&t.charCodeAt(n));return r},bytesToString:function(t){for(var r=[],n=0;n<t.length;n++)r.push(String.fromCharCode(t[n]));return r.join("")}}},T=C,k=function(t){return null!=t&&(I(t)||(r=t,"function"==typeof r.readFloatLE&&"function"==typeof r.slice&&I(r.slice(0,0)))||!!t._isBuffer);var r};function I(t){return!!t.constructor&&"function"==typeof t.constructor.isBuffer&&t.constructor.isBuffer(t)}var N,q,P,B,F=j(function(t){!function(){var r=E,n=T.utf8,e=k,o=T.bin,i=function t(i,a){i.constructor==String?i=a&&"binary"===a.encoding?o.stringToBytes(i):n.stringToBytes(i):e(i)?i=Array.prototype.slice.call(i,0):Array.isArray(i)||(i=i.toString());for(var u=r.bytesToWords(i),s=8*i.length,f=1732584193,c=-271733879,l=-1732584194,h=271733878,p=0;p<u.length;p++)u[p]=16711935&(u[p]<<8|u[p]>>>24)|4278255360&(u[p]<<24|u[p]>>>8);u[s>>>5]|=128<<s%32,u[14+(s+64>>>9<<4)]=s;var v=t._ff,y=t._gg,g=t._hh,d=t._ii;for(p=0;p<u.length;p+=16){var b=f,m=c,w=l,A=h;c=d(c=d(c=d(c=d(c=g(c=g(c=g(c=g(c=y(c=y(c=y(c=y(c=v(c=v(c=v(c=v(c,l=v(l,h=v(h,f=v(f,c,l,h,u[p+0],7,-680876936),c,l,u[p+1],12,-389564586),f,c,u[p+2],17,606105819),h,f,u[p+3],22,-1044525330),l=v(l,h=v(h,f=v(f,c,l,h,u[p+4],7,-176418897),c,l,u[p+5],12,1200080426),f,c,u[p+6],17,-1473231341),h,f,u[p+7],22,-45705983),l=v(l,h=v(h,f=v(f,c,l,h,u[p+8],7,1770035416),c,l,u[p+9],12,-1958414417),f,c,u[p+10],17,-42063),h,f,u[p+11],22,-1990404162),l=v(l,h=v(h,f=v(f,c,l,h,u[p+12],7,1804603682),c,l,u[p+13],12,-40341101),f,c,u[p+14],17,-1502002290),h,f,u[p+15],22,1236535329),l=y(l,h=y(h,f=y(f,c,l,h,u[p+1],5,-165796510),c,l,u[p+6],9,-1069501632),f,c,u[p+11],14,643717713),h,f,u[p+0],20,-373897302),l=y(l,h=y(h,f=y(f,c,l,h,u[p+5],5,-701558691),c,l,u[p+10],9,38016083),f,c,u[p+15],14,-660478335),h,f,u[p+4],20,-405537848),l=y(l,h=y(h,f=y(f,c,l,h,u[p+9],5,568446438),c,l,u[p+14],9,-1019803690),f,c,u[p+3],14,-187363961),h,f,u[p+8],20,1163531501),l=y(l,h=y(h,f=y(f,c,l,h,u[p+13],5,-1444681467),c,l,u[p+2],9,-51403784),f,c,u[p+7],14,1735328473),h,f,u[p+12],20,-1926607734),l=g(l,h=g(h,f=g(f,c,l,h,u[p+5],4,-378558),c,l,u[p+8],11,-2022574463),f,c,u[p+11],16,1839030562),h,f,u[p+14],23,-35309556),l=g(l,h=g(h,f=g(f,c,l,h,u[p+1],4,-1530992060),c,l,u[p+4],11,1272893353),f,c,u[p+7],16,-155497632),h,f,u[p+10],23,-1094730640),l=g(l,h=g(h,f=g(f,c,l,h,u[p+13],4,681279174),c,l,u[p+0],11,-358537222),f,c,u[p+3],16,-722521979),h,f,u[p+6],23,76029189),l=g(l,h=g(h,f=g(f,c,l,h,u[p+9],4,-640364487),c,l,u[p+12],11,-421815835),f,c,u[p+15],16,530742520),h,f,u[p+2],23,-995338651),l=d(l,h=d(h,f=d(f,c,l,h,u[p+0],6,-198630844),c,l,u[p+7],10,1126891415),f,c,u[p+14],15,-1416354905),h,f,u[p+5],21,-57434055),l=d(l,h=d(h,f=d(f,c,l,h,u[p+12],6,1700485571),c,l,u[p+3],10,-1894986606),f,c,u[p+10],15,-1051523),h,f,u[p+1],21,-2054922799),l=d(l,h=d(h,f=d(f,c,l,h,u[p+8],6,1873313359),c,l,u[p+15],10,-30611744),f,c,u[p+6],15,-1560198380),h,f,u[p+13],21,1309151649),l=d(l,h=d(h,f=d(f,c,l,h,u[p+4],6,-145523070),c,l,u[p+11],10,-1120210379),f,c,u[p+2],15,718787259),h,f,u[p+9],21,-343485551),f=f+b>>>0,c=c+m>>>0,l=l+w>>>0,h=h+A>>>0}return r.endian([f,c,l,h])};i._ff=function(t,r,n,e,o,i,a){var u=t+(r&n|~r&e)+(o>>>0)+a;return(u<<i|u>>>32-i)+r},i._gg=function(t,r,n,e,o,i,a){var u=t+(r&e|n&~e)+(o>>>0)+a;return(u<<i|u>>>32-i)+r},i._hh=function(t,r,n,e,o,i,a){var u=t+(r^n^e)+(o>>>0)+a;return(u<<i|u>>>32-i)+r},i._ii=function(t,r,n,e,o,i,a){var u=t+(n^(r|~e))+(o>>>0)+a;return(u<<i|u>>>32-i)+r},i._blocksize=16,i._digestsize=16,t.exports=function(t,n){if(void 0===t||null===t)throw new Error("Illegal argument "+t);var e=r.wordsToBytes(i(t,n));return n&&n.asBytes?e:n&&n.asString?o.bytesToString(e):r.bytesToHex(e)}}()}),_={'"':'"',"\\":"\\","/":"/",b:"\b",f:"\f",n:"\n",r:"\r",t:"\t"},R=function(t){throw{name:"SyntaxError",message:t,at:N,text:P}},U=function(t){return t&&t!==q&&R("Expected '"+t+"' instead of '"+q+"'"),q=P.charAt(N),N+=1,q},z=function(){var t,r="";for("-"===q&&(r="-",U("-"));q>="0"&&q<="9";)r+=q,U();if("."===q)for(r+=".";U()&&q>="0"&&q<="9";)r+=q;if("e"===q||"E"===q)for(r+=q,U(),"-"!==q&&"+"!==q||(r+=q,U());q>="0"&&q<="9";)r+=q,U();if(t=+r,isFinite(t))return t;R("Bad number")},J=function(){var t,r,n,e="";if('"'===q)for(;U();){if('"'===q)return U(),e;if("\\"===q)if(U(),"u"===q){for(n=0,r=0;r<4&&(t=parseInt(U(),16),isFinite(t));r+=1)n=16*n+t;e+=String.fromCharCode(n)}else{if("string"!=typeof _[q])break;e+=_[q]}else e+=q}R("Bad string")},M=function(){for(;q&&q<=" ";)U()};B=function(){switch(M(),q){case"{":return function(){var t,r={};if("{"===q){if(U("{"),M(),"}"===q)return U("}"),r;for(;q;){if(t=J(),M(),U(":"),Object.hasOwnProperty.call(r,t)&&R('Duplicate key "'+t+'"'),r[t]=B(),M(),"}"===q)return U("}"),r;U(","),M()}}R("Bad object")}();case"[":return function(){var t=[];if("["===q){if(U("["),M(),"]"===q)return U("]"),t;for(;q;){if(t.push(B()),M(),"]"===q)return U("]"),t;U(","),M()}}R("Bad array")}();case'"':return J();case"-":return z();default:return q>="0"&&q<="9"?z():function(){switch(q){case"t":return U("t"),U("r"),U("u"),U("e"),!0;case"f":return U("f"),U("a"),U("l"),U("s"),U("e"),!1;case"n":return U("n"),U("u"),U("l"),U("l"),null}R("Unexpected '"+q+"'")}()}};var L,H,G,W=/[\\\"\x00-\x1f\x7f-\x9f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,Z={"\b":"\\b","\t":"\\t","\n":"\\n","\f":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"};function V(t){return W.lastIndex=0,W.test(t)?'"'+t.replace(W,function(t){var r=Z[t];return"string"==typeof r?r:"\\u"+("0000"+t.charCodeAt(0).toString(16)).slice(-4)})+'"':'"'+t+'"'}function Y(t,r){var e,o,i,a,u,s=L,f=r[t];switch(f&&"object"===(void 0===f?"undefined":n(f))&&"function"==typeof f.toJSON&&(f=f.toJSON(t)),"function"==typeof G&&(f=G.call(r,t,f)),void 0===f?"undefined":n(f)){case"string":return V(f);case"number":return isFinite(f)?String(f):"null";case"boolean":case"null":return String(f);case"object":if(!f)return"null";if(L+=H,u=[],"[object Array]"===Object.prototype.toString.apply(f)){for(a=f.length,e=0;e<a;e+=1)u[e]=Y(e,f)||"null";return i=0===u.length?"[]":L?"[\n"+L+u.join(",\n"+L)+"\n"+s+"]":"["+u.join(",")+"]",L=s,i}if(G&&"object"===(void 0===G?"undefined":n(G)))for(a=G.length,e=0;e<a;e+=1)"string"==typeof(o=G[e])&&(i=Y(o,f))&&u.push(V(o)+(L?": ":":")+i);else for(o in f)Object.prototype.hasOwnProperty.call(f,o)&&(i=Y(o,f))&&u.push(V(o)+(L?": ":":")+i);return i=0===u.length?"{}":L?"{\n"+L+u.join(",\n"+L)+"\n"+s+"}":"{"+u.join(",")+"}",L=s,i}}var $="undefined"!=typeof JSON?JSON:{parse:function(t,r){var e;return P=t,N=0,q=" ",e=B(),M(),q&&R("Syntax error"),"function"==typeof r?function t(e,o){var i,a,u=e[o];if(u&&"object"===(void 0===u?"undefined":n(u)))for(i in u)Object.prototype.hasOwnProperty.call(u,i)&&(void 0!==(a=t(u,i))?u[i]=a:delete u[i]);return r.call(e,o,u)}({"":e},""):e},stringify:function(t,r,e){var o;if(L="",H="","number"==typeof e)for(o=0;o<e;o+=1)H+=" ";else"string"==typeof e&&(H=e);if(G=r,r&&"function"!=typeof r&&("object"!==(void 0===r?"undefined":n(r))||"number"!=typeof r.length))throw new Error("JSON.stringify");return Y("",{"":t})}},D=function(t,r){r||(r={}),"function"==typeof r&&(r={cmp:r});var e=r.space||"";"number"==typeof e&&(e=Array(e+1).join(" "));var o,i="boolean"==typeof r.cycles&&r.cycles,a=r.replacer||function(t,r){return r},u=r.cmp&&(o=r.cmp,function(t){return function(r,n){var e={key:r,value:t[r]},i={key:n,value:t[n]};return o(e,i)}}),s=[];return function t(r,o,f,c){var l=e?"\n"+new Array(c+1).join(e):"",h=e?": ":":";if(f&&f.toJSON&&"function"==typeof f.toJSON&&(f=f.toJSON()),void 0!==(f=a.call(r,o,f))){if("object"!==(void 0===f?"undefined":n(f))||null===f)return $.stringify(f);if(X(f)){for(var p=[],v=0;v<f.length;v++){var y=t(f,v,f[v],c+1)||$.stringify(null);p.push(l+e+y)}return"["+p.join(",")+l+"]"}if(-1!==s.indexOf(f)){if(i)return $.stringify("__cycle__");throw new TypeError("Converting circular structure to JSON")}s.push(f);var g=K(f).sort(u&&u(f));for(p=[],v=0;v<g.length;v++){var d=t(f,o=g[v],f[o],c+1);if(d){var b=$.stringify(o)+h+d;p.push(l+e+b)}}return s.splice(s.indexOf(f),1),"{"+p.join(",")+l+"}"}}({"":t},"",t,0)},X=Array.isArray||function(t){return"[object Array]"==={}.toString.call(t)},K=Object.keys||function(t){var r=Object.prototype.hasOwnProperty||function(){return!0},n=[];for(var e in t)r.call(t,e)&&n.push(e);return n};function Q(t){return F(D(t))}function tt(t){this.message=t}Object.setPrototypeOf(tt,Error),(tt.prototype=Object.create(Error.prototype)).name="ImplementationError",tt.prototype.message="",tt.prototype.constructor=tt;function rt(t,r,n){return t+(r-t)*n}function nt(t,r,n){return t<r?r:t>n?n:t}var et=Math.PI/180,ot=180/Math.PI;var it={lerp:rt,constrain:nt,map:function(t,r,n,e,o){return e+(t-r)/(n-r)*(o-e)},wrap:function(t,r,n){return t<r?n-(r-t)%(n-r):r+(t-r)%(n-r)},radians:function(t){return t*et},degrees:function(t){return t*ot},fract:function(t){return t-Math.floor(t)},mod:function(t,r){return t-r*Math.floor(t/r)},clamp:nt,mix:rt,step:function(t,r){return r<t?0:1},smoothstep:function(t,r,n){var e=nt((n-t)/(r-t),0,1);return e*e*(3-2*e)}},at={},ut={},st=34,ft=10,ct=13;function lt(t){return new Function("d","return {"+t.map(function(t,r){return JSON.stringify(t)+": d["+r+"]"}).join(",")+"}")}var ht=function(t){var r=new RegExp('["'+t+"\n\r]"),n=t.charCodeAt(0);function e(t,r){var e,o=[],i=t.length,a=0,u=0,s=i<=0,f=!1;t.charCodeAt(i-1)===ft&&--i,t.charCodeAt(i-1)===ct&&--i;function c(){if(s)return ut;if(f)return f=!1,at;var r,e,o=a;if(t.charCodeAt(o)===st){for(;a++<i&&t.charCodeAt(a)!==st||t.charCodeAt(++a)===st;);return(r=a)>=i?s=!0:(e=t.charCodeAt(a++))===ft?f=!0:e===ct&&(f=!0,t.charCodeAt(a)===ft&&++a),t.slice(o+1,r-1).replace(/""/g,'"')}for(;a<i;){if((e=t.charCodeAt(r=a++))===ft)f=!0;else if(e===ct)f=!0,t.charCodeAt(a)===ft&&++a;else if(e!==n)continue;return t.slice(o,r)}return s=!0,t.slice(o,i)}for(;(e=c())!==ut;){for(var l=[];e!==at&&e!==ut;)l.push(e),e=c();r&&null==(l=r(l,u++))||o.push(l)}return o}function o(r){return r.map(i).join(t)}function i(t){return null==t?"":r.test(t+="")?'"'+t.replace(/"/g,'""')+'"':t}return{parse:function(t,r){var n,o,i=e(t,function(t,e){if(n)return n(t,e-1);o=t,n=r?function(t,r){var n=lt(t);return function(e,o){return r(n(e),o,t)}}(t,r):lt(t)});return i.columns=o||[],i},parseRows:e,format:function(r,n){return null==n&&(n=function(t){var r=Object.create(null),n=[];return t.forEach(function(t){for(var e in t)e in r||n.push(r[e]=e)}),n}(r)),[n.map(i).join(t)].concat(r.map(function(r){return n.map(function(t){return i(r[t])}).join(t)})).join("\n")},formatRows:function(t){return t.map(o).join("\n")}}},pt=ht(",").parse,vt=ht("\t").parse,yt=function(t,r){if(r=r.split(":")[0],!(t=+t))return!1;switch(r){case"http":case"ws":return 80!==t;case"https":case"wss":return 443!==t;case"ftp":return 21!==t;case"gopher":return 70!==t;case"file":return!1}return 0!==t},gt=Object.prototype.hasOwnProperty;function dt(t){return decodeURIComponent(t.replace(/\+/g," "))}var bt={stringify:function(t,r){var n=[];"string"!=typeof(r=r||"")&&(r="?");for(var e in t)gt.call(t,e)&&n.push(encodeURIComponent(e)+"="+encodeURIComponent(t[e]));return n.length?r+n.join("&"):""},parse:function(t){for(var r,n=/([^=?&]+)=?([^&]*)/g,e={};r=n.exec(t);e[dt(r[1])]=dt(r[2]));return e}},mt=/^([a-z][a-z0-9.+-]*:)?(\/\/)?([\S\s]*)/i,wt=/^[A-Za-z][A-Za-z0-9+-.]*:\/\//,At=[["#","hash"],["?","query"],["/","pathname"],["@","auth",1],[NaN,"host",void 0,1,1],[/:(\d+)$/,"port",void 0,1],[NaN,"hostname",void 0,1,1]],jt={hash:1,query:1};function xt(t){var r,e={},o=void 0===(t=t||A.location||{})?"undefined":n(t);if("blob:"===t.protocol)e=new Ot(unescape(t.pathname),{});else if("string"===o){e=new Ot(t,{});for(r in jt)delete e[r]}else if("object"===o){for(r in t)r in jt||(e[r]=t[r]);void 0===e.slashes&&(e.slashes=wt.test(t.href))}return e}function St(t){var r=mt.exec(t);return{protocol:r[1]?r[1].toLowerCase():"",slashes:!!r[2],rest:r[3]}}function Ot(t,r,e){if(!(this instanceof Ot))return new Ot(t,r,e);var o,i,a,u,s,f,c=At.slice(),l=void 0===r?"undefined":n(r),h=0;for("object"!==l&&"string"!==l&&(e=r,r=null),e&&"function"!=typeof e&&(e=bt.parse),r=xt(r),o=!(i=St(t||"")).protocol&&!i.slashes,this.slashes=i.slashes||o&&r.slashes,this.protocol=i.protocol||r.protocol||"",t=i.rest,i.slashes||(c[2]=[/(.*)/,"pathname"]);h<c.length;h++)a=(u=c[h])[0],f=u[1],a!=a?this[f]=t:"string"==typeof a?~(s=t.indexOf(a))&&("number"==typeof u[2]?(this[f]=t.slice(0,s),t=t.slice(s+u[2])):(this[f]=t.slice(s),t=t.slice(0,s))):(s=a.exec(t))&&(this[f]=s[1],t=t.slice(0,s.index)),this[f]=this[f]||(o&&u[3]?r[f]||"":""),u[4]&&(this[f]=this[f].toLowerCase());e&&(this.query=e(this.query)),o&&r.slashes&&"/"!==this.pathname.charAt(0)&&(""!==this.pathname||""!==r.pathname)&&(this.pathname=function(t,r){for(var n=(r||"/").split("/").slice(0,-1).concat(t.split("/")),e=n.length,o=n[e-1],i=!1,a=0;e--;)"."===n[e]?n.splice(e,1):".."===n[e]?(n.splice(e,1),a++):a&&(0===e&&(i=!0),n.splice(e,1),a--);return i&&n.unshift(""),"."!==o&&".."!==o||n.push(""),n.join("/")}(this.pathname,r.pathname)),yt(this.port,this.protocol)||(this.host=this.hostname,this.port=""),this.username=this.password="",this.auth&&(u=this.auth.split(":"),this.username=u[0]||"",this.password=u[1]||""),this.origin=this.protocol&&this.host&&"file:"!==this.protocol?this.protocol+"//"+this.host:"null",this.href=this.toString()}Ot.prototype={set:function(t,r,n){switch(t){case"query":"string"==typeof r&&r.length&&(r=(n||bt.parse)(r)),this[t]=r;break;case"port":this[t]=r,yt(r,this.protocol)?r&&(this.host=this.hostname+":"+r):(this.host=this.hostname,this[t]="");break;case"hostname":this[t]=r,this.port&&(r+=":"+this.port),this.host=r;break;case"host":this[t]=r,/:\d+$/.test(r)?(r=r.split(":"),this.port=r.pop(),this.hostname=r.join(":")):(this.hostname=r,this.port="");break;case"protocol":this.protocol=r.toLowerCase(),this.slashes=!n;break;case"pathname":case"hash":if(r){var e="pathname"===t?"/":"#";this[t]=r.charAt(0)!==e?e+r:r}else this[t]=r;break;default:this[t]=r}for(var o=0;o<At.length;o++){var i=At[o];i[4]&&(this[i[1]]=this[i[1]].toLowerCase())}return this.origin=this.protocol&&this.host&&"file:"!==this.protocol?this.protocol+"//"+this.host:"null",this.href=this.toString(),this},toString:function(t){t&&"function"==typeof t||(t=bt.stringify);var r,e=this.protocol;e&&":"!==e.charAt(e.length-1)&&(e+=":");var o=e+(this.slashes?"//":"");return this.username&&(o+=this.username,this.password&&(o+=":"+this.password),o+="@"),o+=this.host+this.pathname,(r="object"===n(this.query)?t(this.query):this.query)&&(o+="?"!==r.charAt(0)?"?"+r:r),this.hash&&(o+=this.hash),o}},Ot.extractProtocol=St,Ot.location=xt,Ot.qs=bt;var Et=Ot,Ct=w("fs").readFile,Tt=w("request");function kt(t,r){if(y){var n=function(t,r){var n=void 0,e=void 0,o=new Promise(function(){for(var t=arguments.length,r=Array(t),o=0;o<t;o++)r[o]=arguments[o];n=r[0],e=r[1]});if(r.local)Ct(t,r.encoding,function(t,r){t?e(t):n(r)}),o.abort=function(){};else{var i=Tt({url:t,headers:r.headers||{},qs:r.query||{},encoding:r.encoding},function(t,r){t?e(t):((r.statusCode<200||r.statusCode>=300)&&e(r.statusCode),n(r.body))});i.on("abort",function(){e(0)}),o.abort=function(){i.abort()}}return o}(t,r);if("json"===r.type){var e=n.then(function(t){if("string"!=typeof t)throw new Error("Response is unexpectedly not a string");return JSON.parse(t)});return e.abort=function(){n.abort()},e}if("arraybuffer"===r.type){var o=n.then(function(t){if(!(t instanceof Buffer))throw new Error("Response is unexpectedly not a buffer");for(var r=new ArrayBuffer(t.length),n=new Uint8Array(r),e=0;e<t.length;++e)n[e]=t[e];return r});return o.abort=function(){n.abort()},o}return n}return function(t,r){var n=void 0,e=void 0,o=new Promise(function(){for(var t=arguments.length,r=Array(t),o=0;o<t;o++)r[o]=arguments[o];n=r[0],e=r[1]}),i=new Et(t,!0);r.query&&i.set("query",Object.assign({},i.query,r.query));var u=new XMLHttpRequest;if(u.open("get",i.toString(),!0),r.headers)for(var s=Object.keys(r.headers),f=0;f<s.length;++f)u.setRequestHeader.apply(u,a(r.headers[s[f]]));return u.responseType=r.type,u.addEventListener("loadend",function(t){u.status<200||u.status>=300?e(u.status):null!==u.response||"json"!==r.type?n(u.response):e(new Error("Could not parse JSON"))},!1),u.send(),o.abort=function(){u.abort()},o}(t,r)}function It(){for(var t=arguments.length,r=Array(t),n=0;n<t;n++)r[n]=arguments[n];var e=r[0],o=r[1];if("string"!=typeof e){e=(o=e).url}if("string"!=typeof e)throw new Error("The first argument or options.url must be a string");return[e,o=Object.assign({},{type:"text",local:!1,encoding:"utf-8"},o)]}Object.assign(kt,{text:function(){var t=It.apply(void 0,arguments),r=i(t,2),n=r[0],e=r[1];return e.type="text",kt(n,e)},json:function(){var t=It.apply(void 0,arguments),r=i(t,2),n=r[0],e=r[1];return e.type="json",kt(n,e)},buffer:function(){var t=It.apply(void 0,arguments),r=i(t,2),n=r[0],e=r[1];return e.type="arraybuffer",e.encoding=null,kt(n,e)},csv:function(){var t=It.apply(void 0,arguments),r=i(t,2),n=r[0],e=r[1],o=this.text(n,e),a=o.then(function(t){return pt(t,e.row)});return a.abort=function(){o.abort()},a},tsv:function(){var t=It.apply(void 0,arguments),r=i(t,2),n=r[0],e=r[1],o=this.text(n,e),a=o.then(function(t){return vt(t,e.row)});return a.abort=function(){o.abort()},a}});var Nt=r("Semaphore"),qt=function(){function t(r){e(this,t);var n=Nt(this);n.capacity=r,n.available=r,n.queue=[]}return o(t,[{key:"wait",value:function(t){var r=Nt(this),n=new function t(r,n){var o=this;e(this,t);var i=[new Promise(function(t,r){o.resolve=t,o.reject=r}),new Promise(function(t){o.let=t}).then(function(){n(o.resolve,o.reject)})];this.promise=Promise.all(i).then(function(t){return r.signal(),t[0]},function(t){return r.signal(),Promise.reject(t)})}(this,t);return 0===r.available?r.queue.push(n):(--r.available,n.let()),n.promise}},{key:"signal",value:function(){var t=Nt(this);0===t.queue.length?++t.available:t.queue.shift().let()}},{key:"capacity",get:function(){return Nt(this).capacity}},{key:"available",get:function(){return Nt(this).available}}]),t}();function Pt(t){return t instanceof Int8Array||t instanceof Uint8Array||t instanceof Uint8ClampedArray||t instanceof Int16Array||t instanceof Uint16Array||t instanceof Int32Array||t instanceof Uint32Array||t instanceof Float32Array||t instanceof Float64Array}function Bt(t,r,n){return t.slice(r,n)}function Ft(t,r,n){return t.subarray(r,n)}var _t={forEach:function(t,r,n){for(var e=Pt(t)?Ft:Bt,o=t.length-t.length%r,i=0,a=0;i<o;i+=r,++a)n(e(t,i,i+r),a)},some:function(t,r,n){for(var e=t.length-t.length%r,o=Pt(t)?Ft:Bt,i=0,a=0;i<e;i+=r,++a)if(n(o(t,i,i+r),a))return!0;return!1},every:function(t,r,n){for(var e=t.length-t.length%r,o=Pt(t)?Ft:Bt,i=0,a=0;i<e;i+=r,++a)if(!n(o(t,i,i+r),a))return!1;return!0},reduce:function(t,r,n,e){for(var o=e,i=t.length-t.length%r,a=Pt(t)?Ft:Bt,u=0,s=0;u<i;u+=r,++s)o=n(o,a(t,u,u+r),s);return o},set:function(t,r,n){var e=t.length-t.length%r;if(Pt(t))for(var o=0;o<e;o+=r)t.set(n,o);else for(var i=0;i<e;i+=r)for(var a=0;a<r;++a)t[i+a]=n[a];return t},transform:function(t,r,n){var e=t.length-t.length%r;if(Pt(t))for(var o=0,i=0;o<e;o+=r,++i){var a=n(t.slice(o,o+r),i);t.set(a,o)}else for(var u=0,s=0;u<e;u+=r,++s)for(var f=0;f<r;++f){var c=n(t.slice(u,u+r),s);t[u+f]=c[f]}return t}},Rt={Aggregate:c,AggregateFunction:s,Array:l,AssertionError:h,External:m,FilePath:O,Global:d,Hash:Q,ImplementationError:tt,Math:it,Namespace:r,Request:kt,Semaphore:qt,Stride:_t,URL:Et};t.Aggregate=c,t.AggregateFunction=s,t.Array=l,t.AssertionError=h,t.External=m,t.FilePath=O,t.Global=d,t.Hash=Q,t.ImplementationError=tt,t.Math=it,t.Namespace=r,t.Request=kt,t.Semaphore=qt,t.Stride=_t,t.URL=Et,t.default=Rt,Object.defineProperty(t,"__esModule",{value:!0})});