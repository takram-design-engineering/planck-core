!function(r,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports):"function"==typeof define&&define.amd?define(["exports"],t):t(r.Planck=r.Planck||{})}(this,function(r){"use strict";function t(){var r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:void 0,t=Symbol(r);return function(r){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:function(r){return r};return void 0===r[t]&&(r[t]=e({})),r[t]}}function e(r){this.message=r}function n(r){return process.browser?{}:"node"!==N.type?{}:require(r)}function o(){switch(N.type){case"browser":var r=document.currentScript||document._currentScript;return r?r.src:null;case"worker":return self.location.href;case"node":return __filename}throw new Error}function i(r,t){return t={exports:{}},r(t,t.exports),t.exports}function a(r){return!!r.constructor&&"function"==typeof r.constructor.isBuffer&&r.constructor.isBuffer(r)}function u(r){return"function"==typeof r.readFloatLE&&"function"==typeof r.slice&&a(r.slice(0,0))}function s(r){return rr.lastIndex=0,rr.test(r)?'"'+r.replace(rr,function(r){var t=tr[r];return"string"==typeof t?t:"\\u"+("0000"+r.charCodeAt(0).toString(16)).slice(-4)})+'"':'"'+r+'"'}function c(r,t){var e,n,o,i,a,u=Q,f=t[r];switch(f&&"object"===(void 0===f?"undefined":m(f))&&"function"==typeof f.toJSON&&(f=f.toJSON(r)),"function"==typeof $&&(f=$.call(t,r,f)),void 0===f?"undefined":m(f)){case"string":return s(f);case"number":return isFinite(f)?String(f):"null";case"boolean":case"null":return String(f);case"object":if(!f)return"null";if(Q+=Y,a=[],"[object Array]"===Object.prototype.toString.apply(f)){for(i=f.length,e=0;e<i;e+=1)a[e]=c(e,f)||"null";return o=0===a.length?"[]":Q?"[\n"+Q+a.join(",\n"+Q)+"\n"+u+"]":"["+a.join(",")+"]",Q=u,o}if($&&"object"===(void 0===$?"undefined":m($)))for(i=$.length,e=0;e<i;e+=1)"string"==typeof(n=$[e])&&(o=c(n,f))&&a.push(s(n)+(Q?": ":":")+o);else for(n in f)Object.prototype.hasOwnProperty.call(f,n)&&(o=c(n,f))&&a.push(s(n)+(Q?": ":":")+o);return o=0===a.length?"{}":Q?"{\n"+Q+a.join(",\n"+Q)+"\n"+u+"}":"{"+a.join(",")+"}",Q=u,o}}function f(r){this.message=r}function l(r){return decodeURIComponent(r.replace(/\+/g," "))}function p(r){var t,e={},n=void 0===(r=r||F.location||{})?"undefined":m(r);if("blob:"===r.protocol)e=new v(unescape(r.pathname),{});else if("string"===n){e=new v(r,{});for(t in vr)delete e[t]}else if("object"===n){for(t in r)t in vr||(e[t]=r[t]);void 0===e.slashes&&(e.slashes=hr.test(r.href))}return e}function h(r){var t=pr.exec(r);return{protocol:t[1]?t[1].toLowerCase():"",slashes:!!t[2],rest:t[3]}}function y(r,t){for(var e=(t||"/").split("/").slice(0,-1).concat(r.split("/")),n=e.length,o=e[n-1],i=!1,a=0;n--;)"."===e[n]?e.splice(n,1):".."===e[n]?(e.splice(n,1),a++):a&&(0===n&&(i=!0),e.splice(n,1),a--);return i&&e.unshift(""),"."!==o&&".."!==o||e.push(""),e.join("/")}function v(r,t,e){if(!(this instanceof v))return new v(r,t,e);var n,o,i,a,u,s,c=yr.slice(),f=void 0===t?"undefined":m(t),l=this,d=0;for("object"!==f&&"string"!==f&&(e=t,t=null),e&&"function"!=typeof e&&(e=lr.parse),t=p(t),n=!(o=h(r||"")).protocol&&!o.slashes,l.slashes=o.slashes||n&&t.slashes,l.protocol=o.protocol||t.protocol||"",r=o.rest,o.slashes||(c[2]=[/(.*)/,"pathname"]);d<c.length;d++)i=(a=c[d])[0],s=a[1],i!==i?l[s]=r:"string"==typeof i?~(u=r.indexOf(i))&&("number"==typeof a[2]?(l[s]=r.slice(0,u),r=r.slice(u+a[2])):(l[s]=r.slice(u),r=r.slice(0,u))):(u=i.exec(r))&&(l[s]=u[1],r=r.slice(0,u.index)),l[s]=l[s]||(n&&a[3]?t[s]||"":""),a[4]&&(l[s]=l[s].toLowerCase());e&&(l.query=e(l.query)),n&&t.slashes&&"/"!==l.pathname.charAt(0)&&(""!==l.pathname||""!==t.pathname)&&(l.pathname=y(l.pathname,t.pathname)),cr(l.port,l.protocol)||(l.host=l.hostname,l.port=""),l.username=l.password="",l.auth&&(a=l.auth.split(":"),l.username=a[0]||"",l.password=a[1]||""),l.origin=l.protocol&&l.host&&"file:"!==l.protocol?l.protocol+"//"+l.host:"null",l.href=l.toString()}function d(r,t){return new Promise(function(e,n){var o=new gr(r,!0);t.query&&o.set("query",Object.assign({},o.query,t.query));var i=new XMLHttpRequest;i.open("get",o.toString(),!0),t.headers&&Object.entries(t.headers).forEach(function(r){i.setRequestHeader.apply(i,S(r))}),i.responseType=t.type,i.addEventListener("loadend",function(r){i.status<200||i.status>=300?n(i.status):null!==i.response||"json"!==t.type?e(i.response):n(new Error("Could not parse JSON"))},!1),i.send()})}function g(r,t){return t.local?new Promise(function(e,n){wr(r,t.encoding,function(r,t){r?n(r):e(t)})}):new Promise(function(e,n){br({url:r,headers:t.headers||{},qs:t.query||{},encoding:t.encoding},function(r,t){r?n(r):((t.statusCode<200||t.statusCode>=300)&&n(t.statusCode),e(t.body))})})}function w(r,t){if("node"===N.type){var e=g(r,t);return"json"===t.type?e.then(function(r){if("string"!=typeof r)throw new Error("Response is unexpectedly not a string");return JSON.parse(r)}):"arraybuffer"===t.type?e.then(function(r){if(!(r instanceof Buffer))throw new Error("Response is unexpectedly not a buffer");for(var t=new ArrayBuffer(r.length),e=new Uint8Array(t),n=0;n<r.length;++n)e[n]=r[n];return t}):e}return d(r,t)}function b(){for(var r=arguments.length,t=Array(r),e=0;e<r;e++)t[e]=arguments[e];var n=t[0],o=t[1];if("string"!=typeof n&&(n=(o=n).url),"string"!=typeof n)throw new Error("The first argument or options.url must be a string");return o=Object.assign({},{type:"text",local:!1,encoding:"utf-8"},o),[n,o]}var m="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(r){return typeof r}:function(r){return r&&"function"==typeof Symbol&&r.constructor===Symbol&&r!==Symbol.prototype?"symbol":typeof r},A=function(r,t){if(!(r instanceof t))throw new TypeError("Cannot call a class as a function")},j=function(){function r(r,t){for(var e=0;e<t.length;e++){var n=t[e];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(r,n.key,n)}}return function(t,e,n){return e&&r(t.prototype,e),n&&r(t,n),t}}(),x=function(){function r(r,t){var e=[],n=!0,o=!1,i=void 0;try{for(var a,u=r[Symbol.iterator]();!(n=(a=u.next()).done)&&(e.push(a.value),!t||e.length!==t);n=!0);}catch(r){o=!0,i=r}finally{try{!n&&u.return&&u.return()}finally{if(o)throw i}}return e}return function(t,e){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return r(t,e);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),S=function(r){if(Array.isArray(r)){for(var t=0,e=Array(r.length);t<r.length;t++)e[t]=r[t];return e}return Array.from(r)},O=t("AggregateFunction"),k=function(){function r(t){if(A(this,r),t!==O)throw new Error;for(var e=O(this),n=arguments.length,o=Array(n>1?n-1:0),i=1;i<n;i++)o[i-1]=arguments[i];e.targets=o}return j(r,[{key:"apply",value:function(r,t,e){return O(this).targets.map(function(r){return Reflect.apply(r,t,e)})}},{key:"getPrototypeOf",value:function(r){return this.constructor.prototype}}],[{key:"new",value:function(){for(var r=arguments.length,t=Array(r),e=0;e<r;e++)t[e]=arguments[e];var n=new(Function.prototype.bind.apply(this,[null].concat([O],t)));return new Proxy(function(){},n)}}]),r}(),E=t("Aggregate"),T=function(){function r(t){if(A(this,r),t!==E)throw new Error;for(var e=E(this),n=arguments.length,o=Array(n>1?n-1:0),i=1;i<n;i++)o[i-1]=arguments[i];e.targets=o}return j(r,[{key:"set",value:function(r,t,e,n){return E(this).targets.forEach(function(r){Reflect.set(r,t,e)}),Reflect.set(r,t,e,n)}},{key:"get",value:function(r,t,e){var n=E(this);return n.targets.every(function(r){return"function"==typeof Reflect.get(r,t)})?k.new.apply(k,S(n.targets.map(function(r){return Reflect.get(r,t).bind(r)}))):Reflect.get(n.targets[0],t,e)}},{key:"getPrototypeOf",value:function(r){return this.constructor.prototype}}],[{key:"new",value:function(){for(var r=arguments.length,t=Array(r),e=0;e<r;e++)t[e]=arguments[e];var n=new(Function.prototype.bind.apply(this,[null].concat([E],t)));return new Proxy({},n)}}]),r}();Object.setPrototypeOf(e,Error),(e.prototype=Object.create(Error.prototype)).name="AssertionError",e.prototype.message="",e.prototype.constructor=e;var C,q,P,B,N={get type(){try{if(new Function("return this === window")())return"browser"}catch(r){}try{if(new Function("return this === self")())return"worker"}catch(r){}try{if(new Function("return this === global")())return"node"}catch(r){}throw new Error},get self(){switch(this.type){case"browser":return window;case"worker":return self;case"node":return global}throw new Error},external:function(r){try{return n(r)}catch(r){N.self.process={browser:!0}}return n(r)}},R=o(),_={get self(){return R},get current(){return o()}},F="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},M=i(function(r){!function(){var t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",e={rotl:function(r,t){return r<<t|r>>>32-t},rotr:function(r,t){return r<<32-t|r>>>t},endian:function(r){if(r.constructor==Number)return 16711935&e.rotl(r,8)|4278255360&e.rotl(r,24);for(var t=0;t<r.length;t++)r[t]=e.endian(r[t]);return r},randomBytes:function(r){for(var t=[];r>0;r--)t.push(Math.floor(256*Math.random()));return t},bytesToWords:function(r){for(var t=[],e=0,n=0;e<r.length;e++,n+=8)t[n>>>5]|=r[e]<<24-n%32;return t},wordsToBytes:function(r){for(var t=[],e=0;e<32*r.length;e+=8)t.push(r[e>>>5]>>>24-e%32&255);return t},bytesToHex:function(r){for(var t=[],e=0;e<r.length;e++)t.push((r[e]>>>4).toString(16)),t.push((15&r[e]).toString(16));return t.join("")},hexToBytes:function(r){for(var t=[],e=0;e<r.length;e+=2)t.push(parseInt(r.substr(e,2),16));return t},bytesToBase64:function(r){for(var e=[],n=0;n<r.length;n+=3)for(var o=r[n]<<16|r[n+1]<<8|r[n+2],i=0;i<4;i++)8*n+6*i<=8*r.length?e.push(t.charAt(o>>>6*(3-i)&63)):e.push("=");return e.join("")},base64ToBytes:function(r){r=r.replace(/[^A-Z0-9+\/]/gi,"");for(var e=[],n=0,o=0;n<r.length;o=++n%4)0!=o&&e.push((t.indexOf(r.charAt(n-1))&Math.pow(2,-2*o+8)-1)<<2*o|t.indexOf(r.charAt(n))>>>6-2*o);return e}};r.exports=e}()}),U={utf8:{stringToBytes:function(r){return U.bin.stringToBytes(unescape(encodeURIComponent(r)))},bytesToString:function(r){return decodeURIComponent(escape(U.bin.bytesToString(r)))}},bin:{stringToBytes:function(r){for(var t=[],e=0;e<r.length;e++)t.push(255&r.charCodeAt(e));return t},bytesToString:function(r){for(var t=[],e=0;e<r.length;e++)t.push(String.fromCharCode(r[e]));return t.join("")}}},I=U,J=function(r){return null!=r&&(a(r)||u(r)||!!r._isBuffer)},L=i(function(r){!function(){var t=M,e=I.utf8,n=J,o=I.bin,i=function r(i,a){i.constructor==String?i=a&&"binary"===a.encoding?o.stringToBytes(i):e.stringToBytes(i):n(i)?i=Array.prototype.slice.call(i,0):Array.isArray(i)||(i=i.toString());for(var u=t.bytesToWords(i),s=8*i.length,c=1732584193,f=-271733879,l=-1732584194,p=271733878,h=0;h<u.length;h++)u[h]=16711935&(u[h]<<8|u[h]>>>24)|4278255360&(u[h]<<24|u[h]>>>8);u[s>>>5]|=128<<s%32,u[14+(s+64>>>9<<4)]=s;for(var y=r._ff,v=r._gg,d=r._hh,g=r._ii,h=0;h<u.length;h+=16){var w=c,b=f,m=l,A=p;f=g(f=g(f=g(f=g(f=d(f=d(f=d(f=d(f=v(f=v(f=v(f=v(f=y(f=y(f=y(f=y(f,l=y(l,p=y(p,c=y(c,f,l,p,u[h+0],7,-680876936),f,l,u[h+1],12,-389564586),c,f,u[h+2],17,606105819),p,c,u[h+3],22,-1044525330),l=y(l,p=y(p,c=y(c,f,l,p,u[h+4],7,-176418897),f,l,u[h+5],12,1200080426),c,f,u[h+6],17,-1473231341),p,c,u[h+7],22,-45705983),l=y(l,p=y(p,c=y(c,f,l,p,u[h+8],7,1770035416),f,l,u[h+9],12,-1958414417),c,f,u[h+10],17,-42063),p,c,u[h+11],22,-1990404162),l=y(l,p=y(p,c=y(c,f,l,p,u[h+12],7,1804603682),f,l,u[h+13],12,-40341101),c,f,u[h+14],17,-1502002290),p,c,u[h+15],22,1236535329),l=v(l,p=v(p,c=v(c,f,l,p,u[h+1],5,-165796510),f,l,u[h+6],9,-1069501632),c,f,u[h+11],14,643717713),p,c,u[h+0],20,-373897302),l=v(l,p=v(p,c=v(c,f,l,p,u[h+5],5,-701558691),f,l,u[h+10],9,38016083),c,f,u[h+15],14,-660478335),p,c,u[h+4],20,-405537848),l=v(l,p=v(p,c=v(c,f,l,p,u[h+9],5,568446438),f,l,u[h+14],9,-1019803690),c,f,u[h+3],14,-187363961),p,c,u[h+8],20,1163531501),l=v(l,p=v(p,c=v(c,f,l,p,u[h+13],5,-1444681467),f,l,u[h+2],9,-51403784),c,f,u[h+7],14,1735328473),p,c,u[h+12],20,-1926607734),l=d(l,p=d(p,c=d(c,f,l,p,u[h+5],4,-378558),f,l,u[h+8],11,-2022574463),c,f,u[h+11],16,1839030562),p,c,u[h+14],23,-35309556),l=d(l,p=d(p,c=d(c,f,l,p,u[h+1],4,-1530992060),f,l,u[h+4],11,1272893353),c,f,u[h+7],16,-155497632),p,c,u[h+10],23,-1094730640),l=d(l,p=d(p,c=d(c,f,l,p,u[h+13],4,681279174),f,l,u[h+0],11,-358537222),c,f,u[h+3],16,-722521979),p,c,u[h+6],23,76029189),l=d(l,p=d(p,c=d(c,f,l,p,u[h+9],4,-640364487),f,l,u[h+12],11,-421815835),c,f,u[h+15],16,530742520),p,c,u[h+2],23,-995338651),l=g(l,p=g(p,c=g(c,f,l,p,u[h+0],6,-198630844),f,l,u[h+7],10,1126891415),c,f,u[h+14],15,-1416354905),p,c,u[h+5],21,-57434055),l=g(l,p=g(p,c=g(c,f,l,p,u[h+12],6,1700485571),f,l,u[h+3],10,-1894986606),c,f,u[h+10],15,-1051523),p,c,u[h+1],21,-2054922799),l=g(l,p=g(p,c=g(c,f,l,p,u[h+8],6,1873313359),f,l,u[h+15],10,-30611744),c,f,u[h+6],15,-1560198380),p,c,u[h+13],21,1309151649),l=g(l,p=g(p,c=g(c,f,l,p,u[h+4],6,-145523070),f,l,u[h+11],10,-1120210379),c,f,u[h+2],15,718787259),p,c,u[h+9],21,-343485551),c=c+w>>>0,f=f+b>>>0,l=l+m>>>0,p=p+A>>>0}return t.endian([c,f,l,p])};i._ff=function(r,t,e,n,o,i,a){var u=r+(t&e|~t&n)+(o>>>0)+a;return(u<<i|u>>>32-i)+t},i._gg=function(r,t,e,n,o,i,a){var u=r+(t&n|e&~n)+(o>>>0)+a;return(u<<i|u>>>32-i)+t},i._hh=function(r,t,e,n,o,i,a){var u=r+(t^e^n)+(o>>>0)+a;return(u<<i|u>>>32-i)+t},i._ii=function(r,t,e,n,o,i,a){var u=r+(e^(t|~n))+(o>>>0)+a;return(u<<i|u>>>32-i)+t},i._blocksize=16,i._digestsize=16,r.exports=function(r,e){if(void 0===r||null===r)throw new Error("Illegal argument "+r);var n=t.wordsToBytes(i(r,e));return e&&e.asBytes?n:e&&e.asString?o.bytesToString(n):t.bytesToHex(n)}}()}),D={'"':'"',"\\":"\\","/":"/",b:"\b",f:"\f",n:"\n",r:"\r",t:"\t"},z=function(r){throw{name:"SyntaxError",message:r,at:C,text:P}},H=function(r){return r&&r!==q&&z("Expected '"+r+"' instead of '"+q+"'"),q=P.charAt(C),C+=1,q},K=function(){var r,t="";for("-"===q&&(t="-",H("-"));q>="0"&&q<="9";)t+=q,H();if("."===q)for(t+=".";H()&&q>="0"&&q<="9";)t+=q;if("e"===q||"E"===q)for(t+=q,H(),"-"!==q&&"+"!==q||(t+=q,H());q>="0"&&q<="9";)t+=q,H();if(r=+t,isFinite(r))return r;z("Bad number")},V=function(){var r,t,e,n="";if('"'===q)for(;H();){if('"'===q)return H(),n;if("\\"===q)if(H(),"u"===q){for(e=0,t=0;t<4&&(r=parseInt(H(),16),isFinite(r));t+=1)e=16*e+r;n+=String.fromCharCode(e)}else{if("string"!=typeof D[q])break;n+=D[q]}else n+=q}z("Bad string")},Z=function(){for(;q&&q<=" ";)H()},G=function(){switch(q){case"t":return H("t"),H("r"),H("u"),H("e"),!0;case"f":return H("f"),H("a"),H("l"),H("s"),H("e"),!1;case"n":return H("n"),H("u"),H("l"),H("l"),null}z("Unexpected '"+q+"'")},W=function(){var r=[];if("["===q){if(H("["),Z(),"]"===q)return H("]"),r;for(;q;){if(r.push(B()),Z(),"]"===q)return H("]"),r;H(","),Z()}}z("Bad array")},X=function(){var r,t={};if("{"===q){if(H("{"),Z(),"}"===q)return H("}"),t;for(;q;){if(r=V(),Z(),H(":"),Object.hasOwnProperty.call(t,r)&&z('Duplicate key "'+r+'"'),t[r]=B(),Z(),"}"===q)return H("}"),t;H(","),Z()}}z("Bad object")};B=function(){switch(Z(),q){case"{":return X();case"[":return W();case'"':return V();case"-":return K();default:return q>="0"&&q<="9"?K():G()}};var Q,Y,$,rr=/[\\\"\x00-\x1f\x7f-\x9f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,tr={"\b":"\\b","\t":"\\t","\n":"\\n","\f":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"},er={parse:function(r,t){var e;return P=r,C=0,q=" ",e=B(),Z(),q&&z("Syntax error"),"function"==typeof t?function r(e,n){var o,i,a=e[n];if(a&&"object"===(void 0===a?"undefined":m(a)))for(o in a)Object.prototype.hasOwnProperty.call(a,o)&&(void 0!==(i=r(a,o))?a[o]=i:delete a[o]);return t.call(e,n,a)}({"":e},""):e},stringify:function(r,t,e){var n;if(Q="",Y="","number"==typeof e)for(n=0;n<e;n+=1)Y+=" ";else"string"==typeof e&&(Y=e);if($=t,t&&"function"!=typeof t&&("object"!==(void 0===t?"undefined":m(t))||"number"!=typeof t.length))throw new Error("JSON.stringify");return c("",{"":r})}},nr="undefined"!=typeof JSON?JSON:er,or=function(r,t){t||(t={}),"function"==typeof t&&(t={cmp:t});var e=t.space||"";"number"==typeof e&&(e=Array(e+1).join(" "));var n="boolean"==typeof t.cycles&&t.cycles,o=t.replacer||function(r,t){return t},i=t.cmp&&function(r){return function(t){return function(e,n){var o={key:e,value:t[e]},i={key:n,value:t[n]};return r(o,i)}}}(t.cmp),a=[];return function r(t,u,s,c){var f=e?"\n"+new Array(c+1).join(e):"",l=e?": ":":";if(s&&s.toJSON&&"function"==typeof s.toJSON&&(s=s.toJSON()),void 0!==(s=o.call(t,u,s))){if("object"!==(void 0===s?"undefined":m(s))||null===s)return nr.stringify(s);if(ir(s)){for(var p=[],h=0;h<s.length;h++){var y=r(s,h,s[h],c+1)||nr.stringify(null);p.push(f+e+y)}return"["+p.join(",")+f+"]"}if(-1!==a.indexOf(s)){if(n)return nr.stringify("__cycle__");throw new TypeError("Converting circular structure to JSON")}a.push(s);for(var v=ar(s).sort(i&&i(s)),p=[],h=0;h<v.length;h++){var d=r(s,u=v[h],s[u],c+1);if(d){var g=nr.stringify(u)+l+d;p.push(f+e+g)}}return a.splice(a.indexOf(s),1),"{"+p.join(",")+f+"}"}}({"":r},"",r,0)},ir=Array.isArray||function(r){return"[object Array]"==={}.toString.call(r)},ar=Object.keys||function(r){var t=Object.prototype.hasOwnProperty||function(){return!0},e=[];for(var n in r)t.call(r,n)&&e.push(n);return e};Object.setPrototypeOf(f,Error),(f.prototype=Object.create(Error.prototype)).name="ImplementationError",f.prototype.message="",f.prototype.constructor=f;var ur=t("Multiton"),sr=function(){function r(t){if(A(this,r),this.constructor.has(t))throw new Error('Attempt to create multiple instances for key "'+t+'"')}return j(r,null,[{key:"has",value:function(r){var t=ur(this);if(void 0===t.instances)return!1;var e=this.coerceKey(r);return void 0!==t.instances[e]}},{key:"for",value:function(r){var t=ur(this);t.instances||(t.instances=new Map);var e=this.coerceKey(r);if(t.instances.has(e))return t.instances.get(e);for(var n=arguments.length,o=Array(n>1?n-1:0),i=1;i<n;i++)o[i-1]=arguments[i];var a=this.new.apply(this,[e].concat(o));return t.instances.set(e,a),a}},{key:"new",value:function(r){for(var t=arguments.length,e=Array(t>1?t-1:0),n=1;n<t;n++)e[n-1]=arguments[n];return new(Function.prototype.bind.apply(this,[null].concat([r],e)))}},{key:"coerceKey",value:function(r){return r}}]),r}(),cr=function(r,t){if(t=t.split(":")[0],!(r=+r))return!1;switch(t){case"http":case"ws":return 80!==r;case"https":case"wss":return 443!==r;case"ftp":return 21!==r;case"gopher":return 70!==r;case"file":return!1}return 0!==r},fr=Object.prototype.hasOwnProperty,lr={stringify:function(r,t){var e=[];"string"!=typeof(t=t||"")&&(t="?");for(var n in r)fr.call(r,n)&&e.push(encodeURIComponent(n)+"="+encodeURIComponent(r[n]));return e.length?t+e.join("&"):""},parse:function(r){for(var t,e=/([^=?&]+)=?([^&]*)/g,n={};t=e.exec(r);n[l(t[1])]=l(t[2]));return n}},pr=/^([a-z][a-z0-9.+-]*:)?(\/\/)?([\S\s]*)/i,hr=/^[A-Za-z][A-Za-z0-9+-.]*:\/\//,yr=[["#","hash"],["?","query"],["/","pathname"],["@","auth",1],[NaN,"host",void 0,1,1],[/:(\d+)$/,"port",void 0,1],[NaN,"hostname",void 0,1,1]],vr={hash:1,query:1};v.prototype={set:function(r,t,e){var n=this;switch(r){case"query":"string"==typeof t&&t.length&&(t=(e||lr.parse)(t)),n[r]=t;break;case"port":n[r]=t,cr(t,n.protocol)?t&&(n.host=n.hostname+":"+t):(n.host=n.hostname,n[r]="");break;case"hostname":n[r]=t,n.port&&(t+=":"+n.port),n.host=t;break;case"host":n[r]=t,/:\d+$/.test(t)?(t=t.split(":"),n.port=t.pop(),n.hostname=t.join(":")):(n.hostname=t,n.port="");break;case"protocol":n.protocol=t.toLowerCase(),n.slashes=!e;break;case"pathname":n.pathname=t.length&&"/"!==t.charAt(0)?"/"+t:t;break;default:n[r]=t}for(var o=0;o<yr.length;o++){var i=yr[o];i[4]&&(n[i[1]]=n[i[1]].toLowerCase())}return n.origin=n.protocol&&n.host&&"file:"!==n.protocol?n.protocol+"//"+n.host:"null",n.href=n.toString(),n},toString:function(r){r&&"function"==typeof r||(r=lr.stringify);var t,e=this,n=e.protocol;n&&":"!==n.charAt(n.length-1)&&(n+=":");var o=n+(e.slashes?"//":"");return e.username&&(o+=e.username,e.password&&(o+=":"+e.password),o+="@"),o+=e.host+e.pathname,(t="object"===m(e.query)?r(e.query):e.query)&&(o+="?"!==t.charAt(0)?"?"+t:t),e.hash&&(o+=e.hash),o}},v.extractProtocol=h,v.location=p,v.qs=lr;var dr,gr=v,wr=N.external("fs").readFile,br=N.external("request"),mr={text:function(){var r=b.apply(void 0,arguments),t=x(r,2),e=t[0],n=t[1];return n.type="text",w(e,n)},json:function(){var r=b.apply(void 0,arguments),t=x(r,2),e=t[0],n=t[1];return n.type="json",w(e,n)},buffer:function(){var r=b.apply(void 0,arguments),t=x(r,2),e=t[0],n=t[1];return n.type="arraybuffer",n.encoding=null,w(e,n)},csv:function(){var r=b.apply(void 0,arguments),t=x(r,2),e=t[0],n=t[1];return this.text(e,n).then(function(r){return N.self.d3.csvParse(r,n.row)})},tsv:function(){var r=b.apply(void 0,arguments),t=x(r,2),e=t[0],n=t[1];return this.text(e,n).then(function(r){return N.self.d3.tsvParse(r,n.row)})}},Ar=t("Semaphore"),jr=function r(t,e){var n=this;A(this,r);var o=[new Promise(function(r,t){n.resolve=r,n.reject=t}),new Promise(function(r){n.let=r}).then(function(){e(n.resolve,n.reject)})];this.promise=Promise.all(o).then(function(r){return t.signal(),r[0]},function(r){return t.signal(),Promise.reject(r)})},xr=function(){function r(t){A(this,r);var e=Ar(this);e.capacity=t,e.available=t,e.queue=[]}return j(r,[{key:"wait",value:function(r){var t=Ar(this),e=new jr(this,r);return 0===t.available?t.queue.push(e):(--t.available,e.let()),e.promise}},{key:"signal",value:function(){var r=Ar(this);0===r.queue.length?++r.available:r.queue.shift().let()}},{key:"capacity",get:function(){return Ar(this).capacity}},{key:"available",get:function(){return Ar(this).available}}]),r}(),Sr=t("Singleton"),Or=function(){function r(){if(A(this,r),void 0!==Sr(this.constructor).instance)throw new Error("Attempt to create multiple instances for singleton")}return j(r,null,[{key:"get",value:function(){var r=Sr(this);return void 0===r.instance&&(r.instance=this.new.apply(this,arguments)),r.instance}},{key:"new",value:function(){for(var r=arguments.length,t=Array(r),e=0;e<r;e++)t[e]=arguments[e];return new(Function.prototype.bind.apply(this,[null].concat(t)))}}]),r}(),kr={forEach:function(r,t,e){var n=[];r.forEach(function(r,o){var i=o%t;n[i]=r,i===t-1&&e(n,Math.floor(o/t))})},some:function(r,t,e){var n=[];return r.some(function(r,o){var i=o%t;return n[i]=r,i===t-1&&e(n,Math.floor(o/t))})},every:function(r,t,e){var n=[];return r.every(function(r,o){var i=o%t;return n[i]=r,i!==t-1||e(n,Math.floor(o/t))})},reduce:function(r,t,e,n){var o=[];return r.reduce(function(r,n,i){var a=i%t;return o[a]=n,a===t-1?e(r,o,Math.floor(i/t)):r},n)},transform:function(r,t,e){var n=[];return r.forEach(function(o,i){var a=i%t;if(n[a]=o,a===t-1)for(var u=e(n,Math.floor(i/t)),s=0;s<t;++s)r[i-(t-s-1)]=u[s]}),r}},Er=i(function(r,t){!function(){for(var r="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",e=new Uint8Array(256),n=0;n<r.length;n++)e[r.charCodeAt(n)]=n;t.encode=function(t){var e,n=new Uint8Array(t),o=n.length,i="";for(e=0;e<o;e+=3)i+=r[n[e]>>2],i+=r[(3&n[e])<<4|n[e+1]>>4],i+=r[(15&n[e+1])<<2|n[e+2]>>6],i+=r[63&n[e+2]];return o%3==2?i=i.substring(0,i.length-1)+"=":o%3==1&&(i=i.substring(0,i.length-2)+"=="),i},t.decode=function(r){var t,n,o,i,a,u=.75*r.length,s=r.length,c=0;"="===r[r.length-1]&&(u--,"="===r[r.length-2]&&u--);var f=new ArrayBuffer(u),l=new Uint8Array(f);for(t=0;t<s;t+=4)n=e[r.charCodeAt(t)],o=e[r.charCodeAt(t+1)],i=e[r.charCodeAt(t+2)],a=e[r.charCodeAt(t+3)],l[c++]=n<<2|o>>4,l[c++]=(15&o)<<4|i>>2,l[c++]=(3&i)<<6|63&a;return f}}()}),Tr=N.external("text-encoding"),Cr={encode:function(r){var t=N.self.TextEncoder||Tr.TextEncoder;if(void 0===t)throw new Error("TextEncoder is missing");var e=new t,n=JSON.stringify(r);return e.encode(n).buffer},decode:function(r){var t=N.self.TextDecoder||Tr.TextDecoder;if(void 0===t)throw new Error("TextDecoder is missing");var e=new t,n=new DataView(r),o=e.decode(n);return JSON.parse(o)},pack:function(r){return Er.encode(r)},unpack:function(r){return Er.decode(r)},packBufferGeometry:function(r){var t=this;Object.values(r.data.attributes).forEach(function(r){var e=new(0,N.self[r.type])(r.array).buffer;r.array=t.pack(e)})},unpackBufferGeometry:function(r){var t=this;Object.values(r.data.attributes).forEach(function(r){var e=N.self[r.type],n=t.unpack(r.array);r.array=Array.from(new e(n))})}},qr=F.crypto||F.msCrypto;if(qr&&qr.getRandomValues){var Pr=new Uint8Array(16);dr=function(){return qr.getRandomValues(Pr),Pr}}if(!dr){var Br=new Array(16);dr=function(){for(var r,t=0;t<16;t++)0==(3&t)&&(r=4294967296*Math.random()),Br[t]=r>>>((3&t)<<3)&255;return Br}}for(var Nr=dr,Rr=[],_r=0;_r<256;++_r)Rr[_r]=(_r+256).toString(16).substr(1);var Fr=function(r,t){var e=t||0,n=Rr;return n[r[e++]]+n[r[e++]]+n[r[e++]]+n[r[e++]]+"-"+n[r[e++]]+n[r[e++]]+"-"+n[r[e++]]+n[r[e++]]+"-"+n[r[e++]]+n[r[e++]]+"-"+n[r[e++]]+n[r[e++]]+n[r[e++]]+n[r[e++]]+n[r[e++]]+n[r[e++]]},Mr=Nr(),Ur=[1|Mr[0],Mr[1],Mr[2],Mr[3],Mr[4],Mr[5]],Ir=16383&(Mr[6]<<8|Mr[7]),Jr=0,Lr=0,Dr=function(r,t,e){var n=t&&e||0;"string"==typeof r&&(t="binary"==r?new Array(16):null,r=null);var o=(r=r||{}).random||(r.rng||Nr)();if(o[6]=15&o[6]|64,o[8]=63&o[8]|128,t)for(var i=0;i<16;++i)t[n+i]=o[i];return t||Fr(o)},zr=Dr;zr.v1=function(r,t,e){var n=t&&e||0,o=t||[],i=void 0!==(r=r||{}).clockseq?r.clockseq:Ir,a=void 0!==r.msecs?r.msecs:(new Date).getTime(),u=void 0!==r.nsecs?r.nsecs:Lr+1,s=a-Jr+(u-Lr)/1e4;if(s<0&&void 0===r.clockseq&&(i=i+1&16383),(s<0||a>Jr)&&void 0===r.nsecs&&(u=0),u>=1e4)throw new Error("uuid.v1(): Can't create more than 10M uuids/sec");Jr=a,Lr=u,Ir=i;var c=(1e4*(268435455&(a+=122192928e5))+u)%4294967296;o[n++]=c>>>24&255,o[n++]=c>>>16&255,o[n++]=c>>>8&255,o[n++]=255&c;var f=a/4294967296*1e4&268435455;o[n++]=f>>>8&255,o[n++]=255&f,o[n++]=f>>>24&15|16,o[n++]=f>>>16&255,o[n++]=i>>>8|128,o[n++]=255&i;for(var l=r.node||Ur,p=0;p<6;++p)o[n+p]=l[p];return t||Fr(o)},zr.v4=Dr;var Hr=zr;r.Aggregate=T,r.AggregateFunction=k,r.AssertionError=e,r.Environment=N,r.FilePath=_,r.Hash=function(r){return L(or(r))},r.ImplementationError=f,r.Multiton=sr,r.Namespace=t,r.Request=mr,r.Semaphore=xr,r.Singleton=Or,r.Stride=kr,r.Transferral=Cr,r.URL=gr,r.UUID=function(){return Hr.v4()},Object.defineProperty(r,"__esModule",{value:!0})});